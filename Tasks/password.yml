---
  - name: Installing python3
    apt: 
      name: python3
      state: latest

  - name: Installing python3-pip
    apt:
      name: python3-pip
      state: latest

  - name: Installing the hash.py requirements
    pip:
      requirements: ../requirements.txt
      executable: pip3


  - name: Running the hash.py
    script: /Files/hash.py
    args:
      executable: python3

  - name: Loading the hashed password
    include_vars: "{{ item }}"
    loop: 
      - ./Files/hashed.yml

  - name: Setting the password
    user:
      name: pi
      state: present
      password: "{{ hash }}"